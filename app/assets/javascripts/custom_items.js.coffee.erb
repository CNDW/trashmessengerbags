# Place all the behaviors and hooks related to the matching controller here.
# All this logic will automatically be available in application.js.
# You can use CoffeeScript in this file: http://coffeescript.org/
types = new Array()
<% ProductType.all.each do |type| %>
types.push [<%= type.id %>, <%= type.product_category_id %>]
<% end %>
models = new Array()
<% ProductModel.all.each do |model| %>
models.push [<%= model.id %>, <%= model.product_type_id %>]
<% end %>

categoryRadio = ".custom_product .category input[type=radio]"
typeRadio = ".custom_product .type input[type=radio]"
modelRadio = ".custom_product .model input[type=radio]"

$ ->
    $(categoryRadio).on "click", ->
        $(".custom_product .type").show()
        $(typeRadio + ":checked").attr('checked', false)
        category_id = Number($(categoryRadio + ":checked").val())
        types.forEach (type)->
            if (type[1] == category_id)
                $(typeRadio + "[value=" + type[0] + "]").show()
                $(typeRadio + "[value=" + type[0] + "] + label").show()
            if (type[1] != category_id)
                $(typeRadio + "[value=" + type[0] + "]").hide()
                $(typeRadio + "[value=" + type[0] + "] + label").hide()


$ ->
    $(typeRadio).on "click", ->
        $(".custom_product .model").show()
        $(modelRadio + ":checked").attr('checked', false)
        type_id = Number($(typeRadio + ":checked").val())
        models.forEach (model)->
            if (model[1] == type_id)
                $(modelRadio + "[value=" + model[0] + "]").show()
                $(modelRadio + "[value=" + model[0] + "] + label").show()
            if (model[1] != type_id)
                $(modelRadio + "[value=" + model[0] + "]").hide()
                $(modelRadio + "[value=" + model[0] + "] + label").hide()


$ ->
    $(".custom_product .model").on "click", "input:radio", ->
        #$(this).parents("form").trigger("submit")